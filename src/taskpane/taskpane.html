<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FactCheck Add-in</title>
  <link rel="stylesheet" href="taskpane.css" />
  <!-- Office.js を先読み込み -->
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
  <!-- サイドロード中に表示するメッセージ -->
  <div id="sideload-msg" class="sideload-message">
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p>PowerPoint で読み込み中...</p>
    </div>
  </div>

  <!-- Office.onReady 後に表示するメイン UI -->
  <div id="app-body" class="app-container">
    <!-- ヘッダーセクション -->
    <header class="app-header">
      <div class="header-content">
        <div class="app-icon">📊</div>
        <div class="header-text">
          <h1 class="app-title">FactCheck</h1>
          <p class="app-subtitle">AI駆動のファクトチェック</p>
        </div>
      </div>
    </header>

    <!-- メインアクションセクション -->
    <details class="action-section" open>
      <summary class="action-toggle">
        <span class="toggle-icon">⚙️</span>
        <span>ファクトチェック実行</span>
      </summary>
      <div class="action-content">
        <button id="run" class="primary-button">
          <span class="button-icon">🔍</span>
          <span class="button-text">ファクトチェック開始</span>
        </button>
        <p class="action-description">PowerPointのテキストを自動でファクトチェックします</p>
      </div>
    </details>

    <!-- 結果セクション -->
    <section class="results-section">
      <div class="section-header">
        <h2 class="section-title">📋 ファクトチェック結果</h2>
      </div>
      <div id="resultsContainer" class="results-container">
        <div class="empty-state">
          <div class="empty-state-icon">🎯</div>
          <p>ファクトチェックを開始すると、結果がここに表示されます</p>
        </div>
      </div>
      <!-- ローディング状態 -->
      <div id="loadingState" class="loading-state" style="display: none;">
        <div class="loading-content">
          <div class="loading-spinner-large"></div>
          <h3 class="loading-title">ファクトチェック実行中...</h3>
          <p class="loading-subtitle">AIが全てのテキストを検証しています</p>
          <div class="loading-progress">
            <div class="progress-bar">
              <div id="progressFill" class="progress-fill"></div>
            </div>
            <p id="progressText" class="progress-text">準備中...</p>
          </div>
        </div>
      </div>
    </section>

    <!-- デバッグログセクション -->
    <details class="debug-section">
      <summary class="debug-toggle">
        <span class="debug-icon">🔧</span>
        <span>デバッグログ</span>
      </summary>
      <div id="logArea" class="log-container">
        <!-- run() 内で logToScreen() がここに書き込む -->
      </div>
    </details>
  </div>

  <!-- 自前の JavaScript を読み込む -->
  <script src="taskpane.js"></script>
</body>
</html>

